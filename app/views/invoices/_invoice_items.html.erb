<% if request.format.pdf? %>
  <% num = 0 %>
  <div class="a4invtbl primary">
    <table class="invoice-items bordered" cellpadding="0" cellspacing="0" style="table-layout: auto">
      <thead>
      <tr>
        <th class="align_left s_no_col"><%= t('views.common.serial_number') %></th>
        <th><%= t('views.common.description') %></th>
        <th class="center-align"><%= t('views.common.unit_cost') %></th>
        <th class="center-align"><%= t('views.items.quantity') %></th>
        <th class="align_right"><%= t('views.common.total') %></th>
      </tr>
      </thead>
      <tfoot>
      </tfoot>

      <tbody>

      <%  invoice.invoice_line_items.first(11).each do |item|
        item_line_total= (item.item_unit_cost ||0) * (item.item_quantity ||0)
%>
        <tr class="invoice-pdf-row">
          <td class="align_left"><%= num+=1 %></td>
          <td class="description"><%= "#{item.item_name}: #{item.item_description}" %></td>
          <td class="center-align"><%= number_to_currency(item.item_unit_cost, unit: invoice.currency.code) %></td>
          <td class="center-align"><%= item.item_quantity.to_i %></td>
          <td class="align_right"><%= number_to_currency(item_line_total, unit: invoice.currency.code) %></td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>
  <% invoice.invoice_line_items.find_in_batches(batch_size: 15).each do |items| %>
    <div class="a4invtbl">
      <table class="invoice-items bordered" cellpadding="0" cellspacing="0" style="table-layout: auto">
        <thead>
        <tr>
          <th class="align_left s_no_col"><%= t('views.common.serial_number') %></th>
          <th><%= t('views.common.description') %></th>
          <th class="center-align"><%= t('views.common.unit_cost') %></th>
          <th class="center-align"><%= t('views.items.quantity') %></th>
          <th class="align_right"><%= t('views.common.total') %></th>
        </tr>
        </thead>
        <tfoot>

        </tfoot>

        <tbody>

        <%  items.each do |item|
          item_line_total= (item.item_unit_cost ||0) * (item.item_quantity ||0)
%>
          <tr class="invoice-pdf-row">
            <td class="align_left"><%= num+= 1 %></td>
            <td class="description"><%= "#{item.item_name}: #{item.item_description}" %></td>
            <td class="center-align"><%= number_to_currency(item.item_unit_cost, unit: invoice.currency.code) %></td>
            <td class="center-align"><%= item.item_quantity.to_i %></td>
            <td class="align_right"><%= number_to_currency(item_line_total, unit: invoice.currency.code) %></td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>
  <% end %>
<% else %>
  <table class="invoice-items bordered" cellpadding="0" cellspacing="0" style="table-layout: auto">
    <thead>
    <tr>
      <th class="align_left s_no_col"><%= t('views.common.serial_number') %></th>
      <th><%= t('views.common.description') %></th>
      <th class="center-align"><%= t('views.common.unit_cost') %></th>
      <th class="center-align"><%= t('views.items.quantity') %></th>
      <th class="align_right"><%= t('views.common.total') %></th>
    </tr>
    </thead>

    <tbody>
    <% invoice.invoice_line_items.each_with_index do |item, i|
      item_line_total= (item.item_unit_cost ||0) * (item.item_quantity ||0)
%>
      <div style="page-break-inside: avoid; display: inline-table">
        
        <td class="align_left"><%= i + 1 %></td>
        <td><%= "#{item.item_name}: #{item.item_description}" %></td>
        <td class="center-align"><%= number_to_currency(item.item_unit_cost, unit: invoice.currency.code) %></td>
        <td class="center-align"><%= item.item_quantity.to_i %></td>
        <td class="align_right"><%= number_to_currency(item_line_total, unit: invoice.currency.code) %></td>
        </tr>
      </div>


    <% end %>
    </tbody>
  </table>
<% end %>